<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Bengali Panjika (Advanced)</title>
    <style>
        :root {
            --primary-red: #b71c1c;       /* Deep Panjika Red */
            --accent-gold: #ffb300;       /* Wedding Gold */
            --text-main: #212121;
            --bg-body: #fffbf0;           /* Cream Background */
            --cell-bg: #ffffff;
            --cell-hover: #fafafa;
            --border-color: #e0e0e0;
            
            /* Tag Colors */
            --tag-holiday-bg: #ffebee;
            --tag-holiday-text: #c62828;
            --tag-moon-bg: #e3f2fd;
            --tag-moon-text: #1565c0;
            --tag-dark-bg: #263238;
            --tag-dark-text: #eceff1;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #fff;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #dcdcdc;
        }

        /* --- Header --- */
        header {
            background: linear-gradient(135deg, #b71c1c 0%, #d32f2f 100%);
            color: white;
            padding: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header-title h1 {
            margin: 0;
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        .header-title .ben-year-display {
            font-size: 1.1rem;
            background: rgba(0,0,0,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 5px;
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .btn-nav {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.4);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        .btn-nav:hover { background: rgba(255,255,255,0.3); }

        select {
            padding: 8px;
            border-radius: 6px;
            border: none;
            font-weight: bold;
            cursor: pointer;
        }

        /* --- Calendar Grid --- */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            border-bottom: 1px solid var(--border-color);
            background: #f5f5f5;
            gap: 1px;
        }

        .day-header {
            padding: 12px;
            text-align: center;
            font-weight: 700;
            color: #555;
            background: #fff;
            font-size: 0.9rem;
        }
        .day-header.sunday { color: var(--primary-red); }

        .day-cell {
            background: var(--cell-bg);
            min-height: 120px;
            padding: 8px;
            display: flex;
            flex-direction: column;
            gap: 4px;
            position: relative;
        }
        .day-cell:hover { background-color: var(--cell-hover); }

        /* Date Numbers */
        .date-row {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 4px;
            margin-bottom: 4px;
        }
        
        .eng-date { font-size: 1.5rem; font-weight: 800; color: #333; line-height: 1; }
        .ben-date { font-size: 1.1rem; font-weight: bold; font-family: 'Times New Roman', serif; color: #666; }

        /* Conditional Colors */
        .is-holiday .eng-date, .is-holiday .ben-date,
        .is-sunday .eng-date, .is-sunday .ben-date { color: var(--primary-red); }
        
        .is-sunday { background-color: #fffafa; }
        .is-today { background-color: #e3f2fd; box-shadow: inset 0 0 0 2px #2196f3; }

        /* --- Event Tags --- */
        .tag {
            font-size: 0.75rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .tag-holiday { background: var(--tag-holiday-bg); color: var(--tag-holiday-text); border: 1px solid #ffcdd2; }
        .tag-wedding { background: #fff8e1; color: #f57f17; border: 1px solid #ffe082; }
        .tag-purnima { background: var(--tag-moon-bg); color: var(--tag-moon-text); border: 1px solid #bbdefb; }
        .tag-amavasya { background: var(--tag-dark-bg); color: var(--tag-dark-text); }

        /* --- Footer Info Panel --- */
        .footer-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            background: #f9f9f9;
        }

        .info-card {
            background: white;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
        }

        .info-card h3 {
            margin-top: 0;
            color: var(--primary-red);
            font-size: 1.1rem;
            border-bottom: 2px solid #eee;
            padding-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 250px; /* Increased height for details */
            overflow-y: auto;
        }

        .info-list li {
            padding: 10px 0;
            border-bottom: 1px dashed #eee;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .info-list li:last-child { border-bottom: none; }

        /* Date details styling */
        .date-detail-block {
            display: grid;
            grid-template-columns: 60px 1fr;
            gap: 5px;
            font-size: 0.85rem;
            color: #444;
            margin-top: 4px;
        }
        .date-label { font-weight: bold; color: #777; }
        .date-val { color: #000; }
        
        .ben-month-highlight {
            font-weight: bold;
            color: #d84315;
            display: block;
            margin-bottom: 4px;
        }

        /* SVG Icons */
        .icon { width: 16px; height: 16px; fill: currentColor; }

        @media (max-width: 768px) {
            header { flex-direction: column; text-align: center; }
            .calendar-grid { font-size: 0.8rem; }
            .day-cell { min-height: 80px; }
            .eng-date { font-size: 1.1rem; }
            .ben-date { font-size: 0.9rem; }
            .tag { font-size: 0.65rem; }
            .date-detail-block { grid-template-columns: 1fr; gap: 0; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="controls">
            <button class="btn-nav" onclick="changeMonth(-1)">‚ùÆ Prev</button>
        </div>
        
        <div class="header-title" style="text-align: center;">
            <h1 id="engHeader">January 2026</h1>
            <div class="ben-year-display" id="benHeader">Poush - Magh 1432</div>
        </div>

        <div class="controls">
            <select id="yearSelect" onchange="jumpToYear()"></select>
            <button class="btn-nav" onclick="changeMonth(1)">Next ‚ùØ</button>
        </div>
    </header>

    <div class="calendar-grid">
        <div class="day-header sunday">Sun</div>
        <div class="day-header">Mon</div>
        <div class="day-header">Tue</div>
        <div class="day-header">Wed</div>
        <div class="day-header">Thu</div>
        <div class="day-header">Fri</div>
        <div class="day-header">Sat</div>
    </div>
    
    <div id="calendarBody" class="calendar-grid"></div>

    <div class="footer-panel">
        <div class="info-card">
            <h3>
                <svg class="icon" viewBox="0 0 24 24"><path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2zm-7 5h5v5h-5z"/></svg>
                Holidays & Weddings
            </h3>
            <ul id="holidayList" class="info-list"></ul>
        </div>

        <div class="info-card">
            <h3>
                <svg class="icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                Tithi Timings (Moon)
            </h3>
            <ul id="moonList" class="info-list"></ul>
        </div>

        <div class="info-card">
            <h3>
                <svg class="icon" viewBox="0 0 24 24"><path d="M14 6l-1-2H5v17h2v-7h5l1 2h7V6h-6zm4 8h-4l-1-2H7v6h5l1 2h5v-6z"/></svg>
                Bengali Month Dates
            </h3>
            <ul id="benMonthList" class="info-list"></ul>
        </div>
    </div>
</div>

<script>
    // --- Data Configuration ---
    const bnMonths = ["Boishakh", "Joishtho", "Asharh", "Srabon", "Bhadro", "Ashwin", "Kartik", "Ogrohayon", "Poush", "Magh", "Falgun", "Chaitra"];
    const bnDigits = ['‡ß¶','‡ßß','‡ß®','‡ß©','‡ß™','‡ß´','‡ß¨','‡ß≠','‡ßÆ','‡ßØ'];
    const engMonthsShort = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];

    const today = new Date();
    let currentMonth = today.getMonth();
    let currentYear = today.getFullYear();

    // Mock Wedding Dates (Year-Month-Day)
    const weddingDates = {
        "2026-0-15": true, "2026-0-16": true, "2026-0-22": true,
        "2026-1-4": true,  "2026-1-12": true, "2026-3-18": true
    };

    // Fixed Holidays
    const holidays = {
        "0-1": "New Year's Day", "0-12": "Vivekananda Jayanti", "0-23": "Netaji Jayanti", "0-26": "Republic Day",
        "1-21": "Intl Mother Language Day", "3-15": "Poila Boishakh", "4-1": "May Day", "4-9": "Rabindra Jayanti",
        "7-15": "Independence Day", "9-2": "Gandhi Jayanti", "11-25": "Christmas Day"
    };

    // --- Helpers ---
    function toBnNum(num) {
        return String(num).split('').map(d => bnDigits[d] ?? d).join('');
    }

    function getBengaliDate(date) {
        const year = date.getFullYear();
        const month = date.getMonth();
        const day = date.getDate();
        
        let benYear = (month < 3 || (month === 3 && day < 15)) ? year - 594 : year - 593;
        const startOfBenYear = new Date(year, 3, 15);
        const oneDay = 86400000;
        let diffDays = Math.floor((date - startOfBenYear) / oneDay);
        
        if (diffDays < 0) diffDays += (year % 4 === 0) ? 366 : 365;

        const monthLengths = [31, 31, 31, 31, 31, 30, 30, 30, 30, 30, 30, 30];
        if (year % 4 === 0) monthLengths[10] = 31; 

        let daysCount = diffDays;
        let monthIndex = 0;
        for (let i = 0; i < 12; i++) {
            if (daysCount < monthLengths[i]) {
                monthIndex = i;
                break;
            }
            daysCount -= monthLengths[i];
        }
        
        return {
            day: daysCount + 1,
            month: bnMonths[monthIndex],
            monthIndex: monthIndex,
            year: benYear
        };
    }

    function getMoonDetails(date) {
        const knownNewMoon = new Date('2000-01-06T18:14:00Z').getTime();
        const cycle = 29.53058867 * 86400000;
        const current = date.getTime();
        const diff = current - knownNewMoon;
        const phasesPassed = diff / cycle;
        const currentPhase = phasesPassed - Math.floor(phasesPassed);
        
        if (currentPhase < 0.03 || currentPhase > 0.97) return "Amavasya";
        if (currentPhase > 0.47 && currentPhase < 0.53) return "Purnima";
        return null;
    }

    // --- Render Logic ---
    function renderCalendar() {
        const grid = document.getElementById("calendarBody");
        const engHeader = document.getElementById("engHeader");
        const benHeader = document.getElementById("benHeader");
        const holidayList = document.getElementById("holidayList");
        const moonList = document.getElementById("moonList");
        const benMonthList = document.getElementById("benMonthList");

        grid.innerHTML = "";
        holidayList.innerHTML = "";
        moonList.innerHTML = "";
        benMonthList.innerHTML = "";

        const monthName = new Date(currentYear, currentMonth).toLocaleString('default', { month: 'long' });
        engHeader.innerText = `${monthName} ${currentYear}`;

        const firstDay = new Date(currentYear, currentMonth, 1);
        const lastDay = new Date(currentYear, currentMonth + 1, 0);
        const totalDays = lastDay.getDate();
        const startDayIndex = firstDay.getDay();

        const startBen = getBengaliDate(firstDay);
        const endBen = getBengaliDate(lastDay);
        benHeader.innerText = `${startBen.month} - ${endBen.month} ${toBnNum(startBen.year)}`;

        for (let i = 0; i < startDayIndex; i++) {
            let cell = document.createElement("div");
            cell.className = "day-cell";
            cell.style.background = "#f0f0f0";
            grid.appendChild(cell);
        }

        let hasHoliday = false;
        let hasMoon = false;
        let trackedBenMonths = new Set();

        for (let d = 1; d <= totalDays; d++) {
            const dateObj = new Date(currentYear, currentMonth, d);
            const benInfo = getBengaliDate(dateObj);
            const dayOfWeek = dateObj.getDay();
            
            let cell = document.createElement("div");
            cell.className = "day-cell";
            
            const dateKey = `${currentMonth}-${d}`;
            const fullDateKey = `${currentYear}-${currentMonth}-${d}`;
            const isHoliday = holidays[dateKey] ? true : false;
            const isWedding = weddingDates[fullDateKey] ? true : false;
            const moonPhase = getMoonDetails(dateObj);
            const isToday = (dateObj.toDateString() === today.toDateString());
            const isSunday = (dayOfWeek === 0);

            if (isToday) cell.classList.add("is-today");
            if (isSunday) cell.classList.add("is-sunday");
            if (isHoliday) cell.classList.add("is-holiday");

            // --- Grid: Date Header ---
            let dateRow = document.createElement("div");
            dateRow.className = "date-row";
            dateRow.innerHTML = `<span class="eng-date">${d}</span> <span class="ben-date">${toBnNum(benInfo.day)}</span>`;
            cell.appendChild(dateRow);

            // --- Grid: Holiday Tag ---
            if (isHoliday) {
                cell.innerHTML += `<div class="tag tag-holiday">‚òÖ ${holidays[dateKey]}</div>`;
                holidayList.innerHTML += `<li><strong>${d} ${monthName}:</strong> ${holidays[dateKey]}</li>`;
                hasHoliday = true;
            }
            
            // --- Grid: Wedding Tag ---
            if (isWedding) {
                cell.innerHTML += `<div class="tag tag-wedding">üíç Shubho Bibaho</div>`;
                holidayList.innerHTML += `<li><strong>${d} ${monthName}:</strong> <span style="color:#f57f17">Shubho Bibaho</span></li>`;
                hasHoliday = true;
            }

            // --- Footer: Purnima/Amavasya Logic with Eng/Ben Dates ---
            if (moonPhase) {
                const tagClass = moonPhase === "Purnima" ? "tag-purnima" : "tag-amavasya";
                const icon = moonPhase === "Purnima" ? "‚óã" : "‚óè";
                cell.innerHTML += `<div class="tag ${tagClass}">${icon} ${moonPhase}</div>`;
                
                // Calculate Start/End Times & Dates
                // Note: Tithi usually spans two days. We simulate this for the UI.
                const nextDay = new Date(dateObj);
                nextDay.setDate(dateObj.getDate() + 1);
                const nextBenInfo = getBengaliDate(nextDay);
                
                const startTime = "06:42 PM"; // Simulated
                const endTime = "04:15 PM";   // Simulated

                moonList.innerHTML += `
                    <li>
                        <strong style="color:var(--primary-red)">${moonPhase}</strong>
                        <div class="date-detail-block">
                            <span class="date-label">Start:</span>
                            <span class="date-val">${d} ${monthName} (${benInfo.day} ${benInfo.month}) at ${startTime}</span>
                        </div>
                        <div class="date-detail-block">
                            <span class="date-label">End:</span>
                            <span class="date-val">${nextDay.getDate()} ${engMonthsShort[nextDay.getMonth()]} (${nextBenInfo.day} ${nextBenInfo.month}) at ${endTime}</span>
                        </div>
                    </li>
                `;
                hasMoon = true;
            }

            // --- Footer: Bengali Month Start Logic with Eng/Ben Dates ---
            if (benInfo.day === 1) {
                benMonthList.innerHTML += `
                    <li>
                        <span class="ben-month-highlight">${benInfo.month} Mash Begins</span>
                        <div class="date-detail-block">
                            <span class="date-label">English:</span>
                            <span class="date-val">${d} ${monthName}, ${currentYear}</span>
                        </div>
                        <div class="date-detail-block">
                            <span class="date-label">Bengali:</span>
                            <span class="date-val">1 ${benInfo.month}, ${toBnNum(benInfo.year)}</span>
                        </div>
                    </li>
                `;
                trackedBenMonths.add(benInfo.month);
            }

            grid.appendChild(cell);
        }

        if (!hasHoliday) holidayList.innerHTML = "<li>No major holidays or weddings.</li>";
        if (!hasMoon) moonList.innerHTML = "<li>No Purnima or Amavasya in this view.</li>";
        if (trackedBenMonths.size === 0) {
            benMonthList.innerHTML = `<li>No new Bengali month starts in ${monthName}.<br>Ongoing: ${startBen.month}</li>`;
        }
    }

    // --- Init ---
    function init() {
        const select = document.getElementById("yearSelect");
        for (let y = 2024; y <= 2030; y++) {
            let opt = document.createElement("option");
            opt.value = y;
            opt.innerText = y;
            if (y === currentYear) opt.selected = true;
            select.appendChild(opt);
        }
        renderCalendar();
    }

    function changeMonth(step) {
        currentMonth += step;
        if (currentMonth > 11) { currentMonth = 0; currentYear++; }
        else if (currentMonth < 0) { currentMonth = 11; currentYear--; }
        document.getElementById("yearSelect").value = currentYear;
        renderCalendar();
    }

    function jumpToYear() {
        currentYear = parseInt(document.getElementById("yearSelect").value);
        renderCalendar();
    }

    init();

</script>

</body>
</html>
    
